
<div class="game">
  <audio preload="auto" ref="crawlMusic" v-on:ended="crawlMusicEnded">
    <source src="https://s3-us-west-2.amazonaws.com/scottstadtcom/fad/star_wars_crawl.mp3" type="audio/mpeg" />
  </audio>

  <div class="page-controls">
    <md-button id="openCrawlModal" class="md-icon-button" v-if="userIsGameMaster" v-on:click="crawlModalOpen = true"><icon name="crawl"></i></md-button>
    <md-button id="openPlayersModal" class="md-icon-button" v-if="userIsGameMaster" v-on:click="playersModalOpen = true"><icon name="rebel"></i></md-button>
    <md-button id="openSettingsModal" class="md-icon-button" v-if="userIsGameMaster" v-on:click="settingsModalOpen = true"><icon name="empire"></i></md-button>
    <md-button class="md-icon-button"><icon name="menu"></i></md-button>
  </div>

  <div class="panel">
    <div class="row">
      <div class="column">
        <h1 class="section-header">{{ game.title }}</h1>
        <alert ref="gameAlert" :can-close="true"></alert>
        <div class="crawl-pane" v-if="game.crawls">
          <h3>Crawls</h3>
          <md-input-container>
            <label for="movie">Crawls</label>
            <md-select name="movie" id="movie" v-model="movie">
              <option></option>
              <option v-for="option in crawlOptions" :value="option.value">{{ option.label }}</option>
            </md-select>
          </md-input-container>
          <div class="selected-crawl" v-if="selectedCrawl">
            <h5 class="subtitle">
              {{ selectedCrawl.subtitle }}
              <i class="fa fa-play right" v-on:click="playCrawl(selectedCrawl)"></i>
            </h5>
            <p class="synopsis">{{ selectedCrawl.crawl }}</p>
          </div>
          <div class="selected-crawl" v-else>
            <p>No active crawl</p>
          </div>
        </div>
        <div class="players-pane" v-if="game.gameMaster && game.players">
          <h3>Players</h3>
          <div class="player gm">
            <p><div :class="{ 'status-indicator': true, 'online': gameMasterIsOnline }"></div> {{ game.gameMaster.chatHandle }}</p>
          </div>
          <div class="player" v-for="player in game.players">
            <p><div :class="{ 'status-indicator': true, 'online': player | playerIsOnline }"></div> {{ player.chatHandle }}<p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <star-wars-crawl
    :show.sync="activeCrawl.show"
    :title="activeCrawl.title"
    :subtitle="activeCrawl.subtitle"
    :body="activeCrawl.crawl"
    :image="activeCrawl.image">
  </star-wars-crawl>

  <md-dialog md-open-from="#openCrawlModal" ref="crawlDialog" v-if="userIsGameMaster">
    <md-dialog-title>
      <h3>{{ game.title }} Crawls</h3>
      <p>Customizable introductory Star Wars crawl animations. Can be sent to the game's chat window or shared with players.</p>
    </md-dialog-title>
    <md-dialog-content>
      <!-- <component is="crawlMenu" v-on:close="closeCrawlMenu"></component> -->
    </md-dialog-content>
  </md-dialog>

  <md-dialog md-open-from="#openPlayersModal" ref="playersDialog" v-if="userIsGameMaster">
    <md-dialog-title>
      <h3>{{ game.title }} Players</h3>
      <p>Add, approve, or remove players from the game.</p>
    </md-dialog-title>
    <md-dialog-content>
      <!-- <component is="playersMenu" v-on:close="closePlayersMenu"></component> -->
    </md-dialog-content>
  </md-dialog>

  <md-dialog md-open-from="#openSettingsModal" ref="settingsDialog" v-if="userIsGameMaster">
    <md-dialog-title>
      <h3>{{ game.title }} Settings</h3>
      <p>Game specific settings and configuration.</p>
    </md-dialog-title>
    <md-dialog-content>
      <component is="settingsMenu" v-on:close="closeSettingsMenu"></component>
    </md-dialog-content>
  </md-dialog>
</div>
